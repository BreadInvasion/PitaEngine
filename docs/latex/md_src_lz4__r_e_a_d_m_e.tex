The {\ttfamily /lib} directory contains many files, but depending on project\textquotesingle{}s objectives, not all of them are required. Limited systems may want to reduce the nb of source files to include as a way to reduce binary size and dependencies.

Capabilities are added at the \char`\"{}level\char`\"{} granularity, detailed below.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md0}{}\doxysubsubsection{Level 1 \+: Minimal LZ4 build}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md0}
The minimum required is $\ast$$\ast${\ttfamily lz4.\+c}$\ast$$\ast$ and $\ast$$\ast${\ttfamily \mbox{\hyperlink{lz4_8h_source}{lz4.\+h}}}$\ast$$\ast$, which provides the fast compression and decompression algorithms. They generate and decode data using the ../doc/lz4\+\_\+\+Block\+\_\+format.md \char`\"{}\+LZ4 block format\char`\"{}.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md1}{}\doxysubsubsection{Level 2 \+: High Compression variant}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md1}
For more compression ratio at the cost of compression speed, the High Compression variant called {\bfseries{lz4hc}} is available. Add files $\ast$$\ast${\ttfamily lz4hc.\+c}$\ast$$\ast$ and $\ast$$\ast${\ttfamily \mbox{\hyperlink{lz4hc_8h_source}{lz4hc.\+h}}}$\ast$$\ast$. This variant also compresses data using the ../doc/lz4\+\_\+\+Block\+\_\+format.md \char`\"{}\+LZ4 block format\char`\"{}, and depends on regular {\ttfamily lib/lz4.$\ast$} source files.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md2}{}\doxysubsubsection{Level 3 \+: Frame support, for interoperability}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md2}
In order to produce compressed data compatible with {\ttfamily lz4} command line utility, it\textquotesingle{}s necessary to use the ../doc/lz4\+\_\+\+Frame\+\_\+format.md \char`\"{}official interoperable frame format\char`\"{}. This format is generated and decoded automatically by the {\bfseries{lz4frame}} library. Its public API is described in {\ttfamily lib/lz4frame.\+h}. In order to work properly, lz4frame needs all other modules present in {\ttfamily /lib}, including, lz4 and lz4hc, and also {\bfseries{xxhash}}. So it\textquotesingle{}s necessary to also include {\ttfamily xxhash.\+c} and {\ttfamily \mbox{\hyperlink{xxhash_8h_source}{xxhash.\+h}}}.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md3}{}\doxysubsubsection{Level 4 \+: File compression operations}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md3}
As a helper around file operations, the library has been recently extended with {\ttfamily lz4file.\+c} and {\ttfamily \mbox{\hyperlink{lz4file_8h_source}{lz4file.\+h}}} (still considered experimental at the time of this writing). These helpers allow opening, reading, writing, and closing files using transparent LZ4 compression / decompression. As a consequence, using {\ttfamily lz4file} adds a dependency on {\ttfamily \texorpdfstring{$<$}{<}stdio.\+h\texorpdfstring{$>$}{>}}.

{\ttfamily lz4file} relies on {\ttfamily lz4frame} in order to produce compressed data conformant to the ../doc/lz4\+\_\+\+Frame\+\_\+format.md \char`\"{}\+LZ4 Frame format\char`\"{} specification. Consequently, to enable this capability, it\textquotesingle{}s necessary to include all {\ttfamily $\ast$.c} and {\ttfamily $\ast$.h} files from {\ttfamily lib/} directory.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md4}{}\doxysubsubsection{Advanced / Experimental API}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md4}
Definitions which are not guaranteed to remain stable in future versions, are protected behind macros, such as {\ttfamily LZ4\+\_\+\+STATIC\+\_\+\+LINKING\+\_\+\+ONLY}. As the name suggests, these definitions should only be invoked in the context of static linking {\itshape {\bfseries{only}}}. Otherwise, dependent application may fail on API or ABI break in the future. The associated symbols are also not exposed by the dynamic library by default. Should they be nonetheless needed, it\textquotesingle{}s possible to force their publication by using build macros {\ttfamily LZ4\+\_\+\+PUBLISH\+\_\+\+STATIC\+\_\+\+FUNCTIONS} and {\ttfamily LZ4\+F\+\_\+\+PUBLISH\+\_\+\+STATIC\+\_\+\+FUNCTIONS}.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md5}{}\doxysubsubsection{Build macros}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md5}
The following build macro can be selected to adjust source code behavior at compilation time \+:


\begin{DoxyItemize}
\item {\ttfamily LZ4\+\_\+\+FAST\+\_\+\+DEC\+\_\+\+LOOP} \+: this triggers a speed optimized decompression loop, more powerful on modern cpus. This loop works great on {\ttfamily x86}, {\ttfamily x64} and {\ttfamily aarch64} cpus, and is automatically enabled for them. It\textquotesingle{}s also possible to enable or disable it manually, by passing {\ttfamily LZ4\+\_\+\+FAST\+\_\+\+DEC\+\_\+\+LOOP=1} or {\ttfamily 0} to the preprocessor. For example, with {\ttfamily gcc} \+: {\ttfamily -\/DLZ4\+\_\+\+FAST\+\_\+\+DEC\+\_\+\+LOOP=1}, and with {\ttfamily make} \+: {\ttfamily CPPFLAGS+=-\/DLZ4\+\_\+\+FAST\+\_\+\+DEC\+\_\+\+LOOP=1 make lz4}.
\item {\ttfamily LZ4\+\_\+\+DISTANCE\+\_\+\+MAX} \+: control the maximum offset that the compressor will allow. Set to 65535 by default, which is the maximum value supported by lz4 format. Reducing maximum distance will reduce opportunities for LZ4 to find matches, hence will produce a worse compression ratio. Setting a smaller max distance could allow compatibility with specific decoders with limited memory budget. This build macro only influences the compressed output of the compressor.
\item {\ttfamily LZ4\+\_\+\+DISABLE\+\_\+\+DEPRECATE\+\_\+\+WARNINGS} \+: invoking a deprecated function will make the compiler generate a warning. This is meant to invite users to update their source code. Should this be a problem, it\textquotesingle{}s generally possible to make the compiler ignore these warnings, for example with {\ttfamily -\/Wno-\/deprecated-\/declarations} on {\ttfamily gcc}, or {\ttfamily \+\_\+\+CRT\+\_\+\+SECURE\+\_\+\+NO\+\_\+\+WARNINGS} for Visual Studio. This build macro offers another project-\/specific method by defining {\ttfamily LZ4\+\_\+\+DISABLE\+\_\+\+DEPRECATE\+\_\+\+WARNINGS} before including the LZ4 header files.
\item {\ttfamily LZ4\+\_\+\+FORCE\+\_\+\+SW\+\_\+\+BITCOUNT} \+: by default, the compression algorithm tries to determine lengths by using bitcount instructions, generally implemented as fast single instructions in many cpus. In case the target cpus doesn\textquotesingle{}t support it, or compiler intrinsic doesn\textquotesingle{}t work, or feature bad performance, it\textquotesingle{}s possible to use an optimized software path instead. This is achieved by setting this build macros. In most cases, it\textquotesingle{}s not expected to be necessary, but it can be legitimately considered for less common platforms.
\item {\ttfamily LZ4\+\_\+\+ALIGN\+\_\+\+TEST} \+: alignment test ensures that the memory area passed as argument to become a compression state is suitably aligned. This test can be disabled if it proves flaky, by setting this value to 0.
\item {\ttfamily LZ4\+\_\+\+USER\+\_\+\+MEMORY\+\_\+\+FUNCTIONS} \+: replace calls to {\ttfamily \texorpdfstring{$<$}{<}stdlib.\+h\texorpdfstring{$>$}{>}}\textquotesingle{}s {\ttfamily malloc()}, {\ttfamily calloc()} and {\ttfamily free()} by user-\/defined functions, which must be named {\ttfamily LZ4\+\_\+malloc()}, {\ttfamily LZ4\+\_\+calloc()} and {\ttfamily LZ4\+\_\+free()}. User functions must be available at link time.
\item {\ttfamily LZ4\+\_\+\+STATIC\+\_\+\+LINKING\+\_\+\+ONLY\+\_\+\+DISABLE\+\_\+\+MEMORY\+\_\+\+ALLOCATION} \+: Remove support of dynamic memory allocation. For more details, see description of this macro in {\ttfamily lib/lz4.\+c}.
\item {\ttfamily LZ4\+\_\+\+FREESTANDING} \+: by setting this build macro to 1, LZ4/\+HC removes dependencies on the C standard library, including allocation functions and {\ttfamily memmove()}, {\ttfamily memcpy()}, and {\ttfamily memset()}. This build macro is designed to help use LZ4/\+HC in restricted environments (embedded, bootloader, etc). For more details, see description of this macro in {\ttfamily lib/lz4.\+h}.
\item {\ttfamily LZ4\+F\+\_\+\+HEAPMODE} \+: selects how {\ttfamily LZ4\+F\+\_\+compress\+Frame()} allocates the compression state, either on stack (default, value 0) or using heap memory (value 1).
\end{DoxyItemize}\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md6}{}\doxysubsubsection{Makefile variables}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md6}
The following {\ttfamily Makefile} variables can be selected to alter the profile of produced binaries \+:
\begin{DoxyItemize}
\item {\ttfamily BUILD\+\_\+\+SHARED} \+: generate {\ttfamily libzstd} dynamic library (enabled by default)
\item {\ttfamily BUILD\+\_\+\+STATIC} \+: generate {\ttfamily libzstd} static library (enabled by default)
\end{DoxyItemize}\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md7}{}\doxysubsubsection{Amalgamation}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md7}
lz4 source code can be amalgamated into a single file. One can combine all source code into {\ttfamily lz4\+\_\+all.\+c} by using following command\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{cat lz4.c lz4hc.c lz4frame.c > lz4\_all.c}

\end{DoxyCode}
 ({\ttfamily cat} file order is important) then compile {\ttfamily lz4\+\_\+all.\+c}. All {\ttfamily $\ast$.h} files present in {\ttfamily /lib} remain necessary to compile {\ttfamily lz4\+\_\+all.\+c}.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md8}{}\doxysubsubsection{Windows \+: using Min\+GW+\+MSYS to create DLL}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md8}
DLL can be created using Min\+GW+\+MSYS with the {\ttfamily make liblz4} command. This command creates {\ttfamily dll\textbackslash{}liblz4.\+dll} and the import library {\ttfamily dll\textbackslash{}liblz4.\+lib}. To override the {\ttfamily dlltool} command when cross-\/compiling on Linux, just set the {\ttfamily DLLTOOL} variable. Example of cross compilation on Linux with mingw-\/w64 64 bits\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{make BUILD\_STATIC=no CC=x86\_64-\/w64-\/mingw32-\/gcc DLLTOOL=x86\_64-\/w64-\/mingw32-\/dlltool OS=Windows\_NT}

\end{DoxyCode}
 The import library is only required with Visual C++. The header files {\ttfamily \mbox{\hyperlink{lz4_8h_source}{lz4.\+h}}}, {\ttfamily \mbox{\hyperlink{lz4hc_8h_source}{lz4hc.\+h}}}, {\ttfamily \mbox{\hyperlink{lz4frame_8h_source}{lz4frame.\+h}}} and the dynamic library {\ttfamily dll\textbackslash{}liblz4.\+dll} are required to compile a project using gcc/\+Min\+GW. The dynamic library has to be added to linking options. It means that if a project that uses LZ4 consists of a single {\ttfamily test-\/dll.\+c} file it should be linked with {\ttfamily dll\textbackslash{}liblz4.\+dll}. For example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$(CC) \$(CFLAGS) -\/Iinclude/ test-\/dll.c -\/o test-\/dll dll\(\backslash\)liblz4.dll}

\end{DoxyCode}
 The compiled executable will require LZ4 DLL which is available at {\ttfamily dll\textbackslash{}liblz4.\+dll}.\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md9}{}\doxysubsubsection{Miscellaneous}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md9}
Other files present in the directory are not source code. They are \+:


\begin{DoxyItemize}
\item {\ttfamily LICENSE} \+: contains the BSD license text
\item {\ttfamily Makefile} \+: {\ttfamily make} script to compile and install lz4 library (static and dynamic)
\item {\ttfamily liblz4.\+pc.\+in} \+: for {\ttfamily pkg-\/config} (used in {\ttfamily make install})
\item {\ttfamily README.\+md} \+: this file
\end{DoxyItemize}\hypertarget{md_src_lz4__r_e_a_d_m_e_autotoc_md10}{}\doxysubsubsection{License}\label{md_src_lz4__r_e_a_d_m_e_autotoc_md10}
All source material within {\bfseries{lib}} directory are BSD 2-\/Clause licensed. See \mbox{[}LICENSE\mbox{]}(LICENSE) for details. The license is also reminded at the top of each source file. 