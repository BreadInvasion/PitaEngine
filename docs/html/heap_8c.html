<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PITA Engine: src/heap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PITA Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('heap_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">heap.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;heap.h&quot;</code><br />
<code>#include &quot;debug.h&quot;</code><br />
<code>#include &quot;mutex.h&quot;</code><br />
<code>#include &quot;tlsf/tlsf.h&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;windows.h&gt;</code><br />
<code>#include &lt;DbgHelp.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structarena__t.html">arena_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to represent "arenas" within a heap.  <a href="structarena__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlogger__t.html">logger_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to define the memory leak logger.  <a href="structlogger__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheap__t.html">heap_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to define the engine's heap.  <a href="structheap__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab9a466408256113ba1083c28c43cd7ba"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structarena__t.html">arena_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#ab9a466408256113ba1083c28c43cd7ba">arena_t</a></td></tr>
<tr class="memdesc:ab9a466408256113ba1083c28c43cd7ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to represent "arenas" within a heap.  <a href="heap_8c.html#ab9a466408256113ba1083c28c43cd7ba">More...</a><br /></td></tr>
<tr class="separator:ab9a466408256113ba1083c28c43cd7ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ce3e7cefa51e49e317a179be5971dd"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structlogger__t.html">logger_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#af9ce3e7cefa51e49e317a179be5971dd">logger_t</a></td></tr>
<tr class="memdesc:af9ce3e7cefa51e49e317a179be5971dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to define the memory leak logger.  <a href="heap_8c.html#af9ce3e7cefa51e49e317a179be5971dd">More...</a><br /></td></tr>
<tr class="separator:af9ce3e7cefa51e49e317a179be5971dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75c19bcef00dee4542c1ddab212e29a8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structheap__t.html">heap_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a75c19bcef00dee4542c1ddab212e29a8">heap_t</a></td></tr>
<tr class="memdesc:a75c19bcef00dee4542c1ddab212e29a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure to define the engine's heap.  <a href="heap_8c.html#a75c19bcef00dee4542c1ddab212e29a8">More...</a><br /></td></tr>
<tr class="separator:a75c19bcef00dee4542c1ddab212e29a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2f96277dac31fe86acd615a053760f91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structheap__t.html">heap_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a2f96277dac31fe86acd615a053760f91">heap_create</a> (size_t grow_increment)</td></tr>
<tr class="memdesc:a2f96277dac31fe86acd615a053760f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and return an empty heap with minimum grow increment grow_increment.  <a href="heap_8c.html#a2f96277dac31fe86acd615a053760f91">More...</a><br /></td></tr>
<tr class="separator:a2f96277dac31fe86acd615a053760f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49de2190cff9a4489628dcb9f81b9b66"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a49de2190cff9a4489628dcb9f81b9b66">heap_alloc</a> (<a class="el" href="structheap__t.html">heap_t</a> *heap, size_t size, size_t alignment)</td></tr>
<tr class="memdesc:a49de2190cff9a4489628dcb9f81b9b66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a number of bytes equal to size in <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap, aligned an alignment number of bytes from the last block.  <a href="heap_8c.html#a49de2190cff9a4489628dcb9f81b9b66">More...</a><br /></td></tr>
<tr class="separator:a49de2190cff9a4489628dcb9f81b9b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d24a2df5996245973d7711842d55b9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#a1d24a2df5996245973d7711842d55b9d">heap_free</a> (<a class="el" href="structheap__t.html">heap_t</a> *heap, void *address)</td></tr>
<tr class="memdesc:a1d24a2df5996245973d7711842d55b9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the memory block at address in <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap.  <a href="heap_8c.html#a1d24a2df5996245973d7711842d55b9d">More...</a><br /></td></tr>
<tr class="separator:a1d24a2df5996245973d7711842d55b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8c6e8c6fa5933de699ded23aa83774f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heap_8c.html#af8c6e8c6fa5933de699ded23aa83774f">heap_destroy</a> (<a class="el" href="structheap__t.html">heap_t</a> *heap)</td></tr>
<tr class="memdesc:af8c6e8c6fa5933de699ded23aa83774f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap.  <a href="heap_8c.html#af8c6e8c6fa5933de699ded23aa83774f">More...</a><br /></td></tr>
<tr class="separator:af8c6e8c6fa5933de699ded23aa83774f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Mark Haddleton</dd></dl>
<p>The heap is a collective memory handling location, in which we can assign both "arenas" for separate pools of memory, and allocate or destroy specific blocks of memory for use elsewhere in the engine. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="ab9a466408256113ba1083c28c43cd7ba" name="ab9a466408256113ba1083c28c43cd7ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9a466408256113ba1083c28c43cd7ba">&#9670;&#160;</a></span>arena_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structarena__t.html">arena_t</a> <a class="el" href="structarena__t.html">arena_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A structure to represent "arenas" within a heap. </p>
<p >The struct <a class="el" href="structarena__t.html" title="A structure to represent &quot;arenas&quot; within a heap.">arena_t</a> is used to represent specific "arenas", pools of contiguous memory within the heap that can be divided up into blocks, to then be allocated and destroyed as necessary. Arenas are commonly split up based on tasks within the game, so that a task's memory can be freed all at once when that task is complete, but in this specific implementation we just assign new heaps whenever we run out of memory in the current heap. </p>

</div>
</div>
<a id="a75c19bcef00dee4542c1ddab212e29a8" name="a75c19bcef00dee4542c1ddab212e29a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75c19bcef00dee4542c1ddab212e29a8">&#9670;&#160;</a></span>heap_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structheap__t.html">heap_t</a> <a class="el" href="structheap__t.html">heap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A structure to define the engine's heap. </p>
<p >The struct <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> is used to represent the heap, the space within the engine that manages all memory allocation/de-allocation over the course of the program's execution. This implementation of heap uses a tlsf implementation written by Matthew Conte to handle all memory operations. </p>

</div>
</div>
<a id="af9ce3e7cefa51e49e317a179be5971dd" name="af9ce3e7cefa51e49e317a179be5971dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ce3e7cefa51e49e317a179be5971dd">&#9670;&#160;</a></span>logger_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structlogger__t.html">logger_t</a> <a class="el" href="structlogger__t.html">logger_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A structure to define the memory leak logger. </p>
<p >The struct <a class="el" href="structlogger__t.html" title="A structure to define the memory leak logger.">logger_t</a> is used to define the contents of the memory leak logger, implemented to fulfill the requirements of Homework 1 of the Game Architecture class. This structure contains pointers to become a self-contained doubly linked list, as well as functionality to store backtrace entries and the address of the memory allocation being tracked. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a49de2190cff9a4489628dcb9f81b9b66" name="a49de2190cff9a4489628dcb9f81b9b66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49de2190cff9a4489628dcb9f81b9b66">&#9670;&#160;</a></span>heap_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * heap_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheap__t.html">heap_t</a> *&#160;</td>
          <td class="paramname"><em>heap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a number of bytes equal to size in <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap, aligned an alignment number of bytes from the last block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">heap</td><td>The heap to which the new memory will be allocated. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the new block. </td></tr>
    <tr><td class="paramname">alignment</td><td>The number of bytes to "pad" the new block of memory with, in order to assure high-speed access. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The memory address of the newly-allocated block. </dd></dl>

</div>
</div>
<a id="a2f96277dac31fe86acd615a053760f91" name="a2f96277dac31fe86acd615a053760f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f96277dac31fe86acd615a053760f91">&#9670;&#160;</a></span>heap_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structheap__t.html">heap_t</a> * heap_create </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>grow_increment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create and return an empty heap with minimum grow increment grow_increment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grow_increment</td><td>The minimum number of bytes that a newly-created arena may contain. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The newly-created heap. </dd></dl>

</div>
</div>
<a id="af8c6e8c6fa5933de699ded23aa83774f" name="af8c6e8c6fa5933de699ded23aa83774f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8c6e8c6fa5933de699ded23aa83774f">&#9670;&#160;</a></span>heap_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void heap_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheap__t.html">heap_t</a> *&#160;</td>
          <td class="paramname"><em>heap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">heap</td><td>The heap to be destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1d24a2df5996245973d7711842d55b9d" name="a1d24a2df5996245973d7711842d55b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d24a2df5996245973d7711842d55b9d">&#9670;&#160;</a></span>heap_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void heap_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structheap__t.html">heap_t</a> *&#160;</td>
          <td class="paramname"><em>heap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the memory block at address in <a class="el" href="structheap__t.html" title="A structure to define the engine&#39;s heap.">heap_t</a> heap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">heap</td><td>The heap in which the block to be freed is located. </td></tr>
    <tr><td class="paramname">address</td><td>The address of the memory block to be freed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="heap_8c.html">heap.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
